# Chirpy Social Media

A simple social media API built with Go that allows users to post short messages called "chirps".

## Features

- User registration and authentication with JWT tokens
- Create, read, and delete chirps (max 140 characters)
- Automatic profanity filtering
- Refresh token support for extended sessions
- Premium membership (Chirpy Red) via webhook integration
- PostgreSQL database with UUID-based IDs

## Tech Stack

- **Language**: Go 1.24.6
- **Database**: PostgreSQL
- **Authentication**: JWT tokens with Argon2id password hashing
- **Key Libraries**:
  - `github.com/lib/pq` - PostgreSQL driver
  - `github.com/golang-jwt/jwt/v5` - JWT authentication
  - `github.com/google/uuid` - UUID generation
  - `github.com/joho/godotenv` - Environment variable management

## Prerequisites

- Go 1.24.6 or higher
- PostgreSQL database
- sqlc (for generating database code)

## Setup

1. Clone the repository

2. Create a `.env` file in the project root:
```env
DB_URL=postgres://username:password@localhost:5432/chirpy?sslmode=disable
PLATFORM=dev
JWT_SECRET=your-secret-key
POLKA_KEY=your-polka-api-key
```

3. Set up the database:
```bash
# Run the SQL schema
psql -d chirpy -f sql/schema/000_all.sql
```

4. Install dependencies:
```bash
go mod download
```

5. Run the server:
```bash
go run main.go
```

The server will start on `http://localhost:8080`

## API Endpoints

### Health & Metrics
- `GET /api/healthz` - Health check
- `GET /admin/metrics` - View server metrics
- `POST /admin/reset` - Reset database (dev only)

### Authentication
- `POST /api/users` - Register a new user
- `POST /api/login` - Login and receive JWT tokens
- `POST /api/refresh` - Refresh access token
- `POST /api/revoke` - Revoke refresh token
- `PUT /api/users` - Update user email/password

### Chirps
- `POST /api/chirps` - Create a new chirp (requires auth)
- `GET /api/chirps` - Get all chirps (supports `?sort=asc|desc` and `?author_id=<uuid>`)
- `GET /api/chirps/{chirpID}` - Get a specific chirp
- `DELETE /api/chirps/{chirpID}` - Delete a chirp (author only)

### Webhooks
- `POST /api/polka/webhooks` - Handle Polka premium upgrade events

## Project Structure

```
ChirpySocialMedia/
├── main.go                 # Main application entry point
├── internal/
│   ├── auth/              # Authentication utilities
│   └── database/          # Database queries (generated by sqlc)
├── sql/
│   ├── schema/            # Database schema files
│   └── queries/           # SQL query definitions
├── assets/                # Static assets
└── index.html            # Frontend HTML file
```

## License

This project is for educational purposes.
